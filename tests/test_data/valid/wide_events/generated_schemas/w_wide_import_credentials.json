{
    "w_wide_import_credentials": {
        "type": "object",
        "properties": {
            "description": {
                "const": "Fires when credentials are imported, providing metrics about the credential import component of an import operation."
            },
            "owners": {
                "const": [
                    "tester"
                ]
            },
            "meta": {
                "type": "object",
                "properties": {
                    "type": {
                        "const": "w_wide_import_credentials"
                    },
                    "version": {
                        "const": "1.0.1"
                    }
                },
                "required": [
                    "type",
                    "version"
                ],
                "additionalProperties": false
            },
            "app": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The name of the application",
                        "enum": [
                            "Windows"
                        ]
                    },
                    "version": {
                        "type": "string",
                        "description": "The version of the application",
                        "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
                    }
                },
                "required": [
                    "name",
                    "version"
                ],
                "additionalProperties": false
            },
            "global": {
                "type": "object",
                "properties": {
                    "platform": {
                        "type": "string",
                        "description": "The platform the app is running on",
                        "enum": [
                            "Windows"
                        ]
                    },
                    "type": {
                        "type": "string",
                        "description": "The type of application",
                        "enum": [
                            "app"
                        ]
                    },
                    "sample_rate": {
                        "type": "number",
                        "description": "Sample rate for this event"
                    }
                },
                "required": [
                    "platform",
                    "type",
                    "sample_rate"
                ],
                "additionalProperties": false
            },
            "feature": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The feature name for this event",
                        "enum": [
                            "browser-import-credentials"
                        ]
                    },
                    "status": {
                        "type": "string",
                        "description": "The overall status of the operation",
                        "enum": [
                            "SUCCESS",
                            "FAILURE"
                        ]
                    },
                    "data": {
                        "type": "object",
                        "properties": {
                            "ext": {
                                "type": "object",
                                "properties": {
                                    "import_from": {
                                        "type": "string",
                                        "description": "The source of the credential import",
                                        "enum": [
                                            "Google Chrome",
                                            "Microsoft Edge",
                                            "Brave",
                                            "Vivaldi",
                                            "Chromium",
                                            "Bitwarden",
                                            "CSV Logins File",
                                            "LastPass",
                                            "1Password",
                                            "1Password 7"
                                        ]
                                    },
                                    "item_count_bucketed": {
                                        "type": "integer",
                                        "description": "Number of credentials imported, bucketed to preserve privacy",
                                        "enum": [
                                            0,
                                            1,
                                            2,
                                            5,
                                            10,
                                            20,
                                            50,
                                            100,
                                            200,
                                            500,
                                            1000
                                        ]
                                    },
                                    "credential_failure_count_bucketed": {
                                        "type": "integer",
                                        "description": "If status is FAILURE, number of failed credential imports, bucketed to preserve privacy",
                                        "enum": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4,
                                            5
                                        ]
                                    }
                                },
                                "required": [
                                    "import_from",
                                    "item_count_bucketed",
                                    "credential_failure_count_bucketed"
                                ],
                                "additionalProperties": false
                            }
                        },
                        "required": [
                            "ext"
                        ],
                        "additionalProperties": false
                    }
                },
                "required": [
                    "name",
                    "status",
                    "data"
                ],
                "additionalProperties": false
            },
            "context": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Context name for the event",
                        "enum": [
                            "onboarding.import",
                            "settings.import"
                        ]
                    }
                },
                "required": [
                    "name"
                ],
                "additionalProperties": false
            }
        },
        "required": [
            "description",
            "owners",
            "meta",
            "app",
            "global",
            "feature",
            "context"
        ],
        "additionalProperties": false
    }
}